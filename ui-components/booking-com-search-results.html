<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Booking.com Search Results</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    
    body { 
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, Roboto, sans-serif;
      background: #fff;
      overflow-x: hidden;
    }

    .booking-container {
      width: 100%;
      height: 100%;
      overflow-y: hidden;
    }

    .accommodation-home-carousel {
      width: 100%;
      padding: 16px;
    }

    .uitk-carousel {
      position: relative;
      width: 100%;
    }

    .uitk-carousel-container {
      display: flex;
      gap: 16px;
      overflow-x: auto;
      scroll-behavior: smooth;
      scrollbar-width: none;
      -ms-overflow-style: none;
      padding: 4px;
    }

    .uitk-carousel-container::-webkit-scrollbar {
      display: none;
    }

    .uitk-carousel-item {
      flex: 0 0 calc(25% - 12px);
      min-width: 280px;
      max-width: 320px;
    }

    @media (max-width: 1280px) {
      .uitk-carousel-item { flex: 0 0 calc(33.333% - 11px); }
    }

    @media (max-width: 1024px) {
      .uitk-carousel-item { flex: 0 0 calc(50% - 8px); }
    }

    @media (max-width: 768px) {
      .uitk-carousel-item { flex: 0 0 calc(100% - 32px); }
    }

    .carousel-card-visible {
      opacity: 1;
      transform: translateY(0);
      transition: opacity 0.3s ease, transform 0.3s ease;
    }

    .uitk-card {
      background: white;
      border-radius: 12px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1), 0 1px 2px rgba(0,0,0,0.06);
      overflow: hidden;
      transition: all 0.3s ease;
      cursor: pointer;
      position: relative;
      height: 100%;
      display: flex;
      flex-direction: column;
    }

    .uitk-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 10px 25px rgba(0,0,0,0.15), 0 4px 6px rgba(0,0,0,0.1);
    }

    .uitk-layout-flex {
      display: flex;
    }

    .uitk-layout-flex-flex-direction-column {
      flex-direction: column;
    }

    .uitk-layout-flex-item-flex-shrink-0 {
      flex-shrink: 0;
    }

    .uitk-layout-flex-item-flex-grow-1 {
      flex-grow: 1;
    }

    .uitk-layout-flex-justify-content-space-between {
      justify-content: space-between;
    }

    .uitk-layout-flex-align-items-flex-start {
      align-items: flex-start;
    }

    .uitk-image {
      position: relative;
      width: 100%;
      aspect-ratio: 1 / 1;
      overflow: hidden;
      background: #f0f0f0;
    }

    .uitk-image-media {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    .uitk-card-content-section {
      padding: 16px;
      display: flex;
      flex-direction: column;
      flex: 1;
    }

    .uitk-heading-6 {
      font-size: 16px;
      font-weight: 600;
      line-height: 1.3;
      color: #1a1a1a;
      margin-bottom: 8px;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
      padding-right: 8px;
    }

    .uitk-badge {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      min-width: 32px;
      height: 24px;
      padding: 0 8px;
      border-radius: 6px;
      font-size: 13px;
      font-weight: 700;
      flex-shrink: 0;
    }

    .uitk-badge-positive {
      background: #008009;
      color: white;
    }

    .uitk-badge-booking {
      background: #003b95;
      color: white;
    }

    .uitk-text {
      line-height: 1.4;
    }

    .uitk-type-500 {
      font-size: 20px;
      font-weight: 700;
      color: #1a1a1a;
    }

    .uitk-type-200 {
      font-size: 13px;
      color: #6b6b6b;
    }

    .uitk-type-300 {
      font-size: 14px;
      font-weight: 600;
    }

    .truncate {
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .uitk-spacing-margin-blockend-one {
      margin-bottom: 8px;
    }

    .uitk-spacing-margin-blockend-four {
      margin-bottom: 16px;
    }

    .uitk-button-primary {
      width: 100%;
      background: #003b95;
      color: white;
      border: none;
      border-radius: 8px;
      padding: 12px 16px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.2s ease;
      margin-top: 8px;
    }

    .uitk-button-primary:hover {
      background: #002f7a;
    }

    .uitk-carousel-controls {
      position: absolute;
      top: 50%;
      left: 0;
      right: 0;
      display: flex;
      justify-content: space-between;
      transform: translateY(-50%);
      pointer-events: none;
      z-index: 10;
    }

    .uitk-carousel-button-paging {
      pointer-events: all;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: white;
      border: 1px solid #ddd;
      box-shadow: 0 2px 8px rgba(0,0,0,0.15);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
      margin: 0 8px;
    }

    .uitk-carousel-button-paging:hover:not(:disabled) {
      background: #f5f5f5;
      transform: scale(1.05);
    }

    .uitk-carousel-button-paging:disabled {
      opacity: 0.3;
      cursor: not-allowed;
    }

    .uitk-carousel-button-paging-hidden {
      opacity: 0;
      pointer-events: none;
    }

    .uitk-icon {
      width: 20px;
      height: 20px;
      fill: #1a1a1a;
    }

    .uitk-card-link {
      position: absolute;
      inset: 0;
      z-index: 1;
    }

    .is-visually-hidden {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0,0,0,0);
      border: 0;
    }

    .price-section {
      margin-top: auto;
    }

    .sustainability-badge {
      position: absolute;
      top: 8px;
      left: 8px;
      padding: 4px 8px;
      background: rgba(46, 125, 50, 0.95);
      color: white;
      border-radius: 6px;
      font-size: 11px;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 4px;
      z-index: 2;
    }

    .accommodation-type-badge {
      padding: 4px 8px;
      background: #f0f0f0;
      color: #666;
      border-radius: 6px;
      font-size: 11px;
      font-weight: 600;
      text-transform: capitalize;
      display: inline-block;
      margin-bottom: 6px;
    }

    .facilities-preview {
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
      margin-top: 8px;
      font-size: 11px;
      color: #666;
    }

    .facility-icon {
      display: inline-block;
    }
  </style>
</head>
<body>
  <div data-testid="booking-page-view" class="booking-container">
    <div style="display: block;">
      <div data-stid="accommodations-card" class="booking-container">
        <div id="accommodation-card-carousel" class="accommodation-home-carousel">
          <div class="uitk-carousel no-touch items-max-height md" data-stid="carousel-wrapper">
            <div class="uitk-carousel-container use-container-sizing" data-stid="carousel-container" tabindex="0" id="carousel-container">
              <!-- Accommodations will be inserted here -->
            </div>
            <div class="uitk-carousel-controls">
              <button data-stid="carousel-nav-prev" id="prev-btn" aria-label="Show previous card" type="button" class="uitk-carousel-button-paging uitk-carousel-button-paging-prev uitk-carousel-button-paging-hidden">
                <svg class="uitk-icon" aria-label="Show previous card" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                  <title>Show previous card</title>
                  <path d="M10.793 5a.5.5 0 0 0-.354.146l-6.146 6.147a1 1 0 0 0 0 1.414l6.146 6.147a.5.5 0 0 0 .354.146h1.914c.258 0 .385-.322.207-.5l-5.5-5.5H19.5a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5H7.414l5.502-5.502c.175-.18.047-.498-.209-.498h-1.914z"></path>
                </svg>
              </button>
              <button data-stid="carousel-nav-next" id="next-btn" aria-label="Show next card" type="button" class="uitk-carousel-button-paging uitk-carousel-button-paging-next">
                <svg class="uitk-icon" aria-label="Show next card" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                  <title>Show next card</title>
                  <path d="m11.086 5.5 5.5 5.5H4.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h12.086l-5.505 5.505c-.172.18-.043.495.212.495h1.914a.5.5 0 0 0 .354-.146l6.146-6.147a1 1 0 0 0 0-1.414l-6.146-6.147A.5.5 0 0 0 13.207 5h-1.914c-.258 0-.385.322-.207.5z"></path>
                </svg>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    (function() {
      const props = window.__WIDGET_PROPS__ || {};
      const { 
        accommodations = [], 
        destination = 'Search Results', 
        checkIn = '', 
        checkOut = '', 
        nights = 0, 
        totalResults = 0,
        filters = {}
      } = props;
      
      const container = document.getElementById('carousel-container');
      const prevBtn = document.getElementById('prev-btn');
      const nextBtn = document.getElementById('next-btn');
      
      // Generate accommodation cards
      accommodations.forEach((acc, index) => {
        const delay = index * 100;
        const ariaLabel = `${index + 1} out of ${accommodations.length}`;
        const isHidden = index > 3 ? 'aria-hidden="true" tabindex="-1"' : '';
        
        const badgeClass = acc.rating >= 9.0 ? 'uitk-badge-positive' : 'uitk-badge-booking';
        
        // Create facility icons mapping
        const facilityIcons = {
          'wifi': 'üì∂',
          'pool': 'üèä',
          'parking': 'üÖøÔ∏è',
          'gym': 'üí™',
          'spa': 'üíÜ',
          'restaurant': 'üçΩÔ∏è',
          'breakfast': 'ü•ê',
          'beach': 'üèñÔ∏è'
        };
        
        // Show top 3 facilities as icons
        const topFacilities = acc.facilities.slice(0, 3);
        const facilitiesHTML = topFacilities.map(f => {
          const icon = Object.keys(facilityIcons).find(key => f.toLowerCase().includes(key));
          return icon ? facilityIcons[icon] : '';
        }).filter(Boolean).join(' ');
        
        const locationHTML = acc.location && acc.location.distance 
          ? `<div><div class="uitk-text truncate uitk-type-200 uitk-text-secondary-theme uitk-spacing uitk-spacing-margin-blockend-four">üìç ${acc.location.distance}</div></div>`
          : '';
        
        const sustainabilityHTML = acc.sustainability && acc.sustainability.certified 
          ? `<div class="sustainability-badge">üå± Level ${acc.sustainability.level}</div>` 
          : '';
        
        const card = document.createElement('div');
        card.className = 'uitk-carousel-item';
        card.setAttribute('data-stid', 'carousel-item');
        card.setAttribute('aria-label', ariaLabel);
        if (isHidden) {
          card.setAttribute('aria-hidden', 'true');
          card.setAttribute('tabindex', '-1');
        }
        
        card.innerHTML = `
          <div class="carousel-card-visible" style="transition-delay: ${delay}ms;">
            <div class="uitk-card uitk-card-roundcorner-all uitk-card-has-link carousel-card-accommodation-vertical uitk-card-has-primary-theme">
              ${sustainabilityHTML}
              <div class="uitk-layout-flex uitk-layout-flex-flex-direction-column" style="height: 100%;">
                <div class="uitk-layout-flex-item uitk-layout-flex-item-flex-shrink-0">
                  <figure class="uitk-image uitk-card uitk-card-roundcorner-all uitk-spacing uitk-spacing-margin-blockend-one uitk-card-has-primary-theme uitk-image-ratio-1-1 uitk-image-ratio">
                    <div class="uitk-image-placeholder">
                      <img alt="${acc.name}" class="uitk-image-media" src="${acc.mainImage || 'https://via.placeholder.com/400x400/e0e0e0/666666?text=Property'}" loading="lazy" onerror="this.src='https://via.placeholder.com/400x400/e0e0e0/666666?text=Property'">
                    </div>
                  </figure>
                </div>
                <div class="uitk-card-content-section uitk-card-content-section-padded carousel-card-content-section-vertical">
                  <div class="uitk-layout-flex uitk-layout-flex-flex-direction-column uitk-layout-flex-justify-content-space-between" style="height: 100%;">
                    <div class="uitk-layout-flex-item uitk-layout-flex-item-flex-grow-1">
                      <div class="uitk-layout-flex uitk-layout-flex-justify-content-space-between">
                        <div class="uitk-layout-flex uitk-layout-flex-align-items-flex-start uitk-layout-flex-justify-content-space-between uitk-layout-flex-item" style="width: 100%;">
                          <div class="uitk-layout-flex-item uitk-layout-flex-item-flex-grow-1">
                            <div class="accommodation-type-badge">${acc.type}</div>
                            <h3 class="uitk-heading uitk-heading-6 truncate-lines-2 uitk-spacing uitk-spacing-margin-blockend-one uitk-spacing-padding-inlineend-two" type-style-theme="standard">${acc.name}</h3>
                            ${locationHTML}
                            ${facilitiesHTML ? `<div class="facilities-preview">${facilitiesHTML}</div>` : ''}
                          </div>
                          <div class="uitk-layout-flex-item">
                            <span class="uitk-badge uitk-badge-base-small uitk-badge-base-has-text ${badgeClass}">
                              <span class="uitk-badge-base-text" aria-hidden="false">${acc.rating.toFixed(1)}</span>
                            </span>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="uitk-layout-flex-item price-section">
                      <div class="uitk-layout-flex uitk-layout-flex-flex-direction-column uitk-spacing uitk-spacing-margin-blockend-four">
                        <div class="uitk-layout-flex uitk-layout-flex-align-items-center uitk-layout-flex-gap-xsmall uitk-layout-flex-flex-wrap-wrap uitk-layout-flex-item">
                          <div class="uitk-text uitk-type-500 uitk-type-medium uitk-text-emphasis-theme uitk-layout-flex-item-align-self-flex-end uitk-layout-flex-item">$${acc.pricePerNight.toLocaleString()}</div>
                        </div>
                        <div class="uitk-text truncate uitk-type-200 uitk-text-secondary-theme uitk-layout-flex-item">per night</div>
                      </div>
                      <button aria-hidden="true" role="link" type="button" class="uitk-button uitk-button-medium uitk-button-has-text uitk-button-primary" style="z-index: 200;">
                        <div class="uitk-text uitk-type-300 uitk-text-inverse-theme">Book on Booking.com</div>
                      </button>
                    </div>
                  </div>
                </div>
              </div>
              <a aria-label="View details for ${acc.name}" class="uitk-card-link">
                <span class="is-visually-hidden"></span>
              </a>
            </div>
          </div>
        `;
        
        // Add click handler
        const button = card.querySelector('.uitk-button-primary');
        const link = card.querySelector('.uitk-card-link');
        
        [button, link, card].forEach(el => {
          el.addEventListener('click', (e) => {
            e.preventDefault();
            if (window.parent && window.parent.postMessage) {
              window.parent.postMessage({
                type: 'accommodation-selected',
                data: { 
                  id: acc.id, 
                  name: acc.name,
                  price: acc.pricePerNight,
                  rating: acc.rating,
                  type: acc.type
                }
              }, '*');
            }
          });
        });
        
        container.appendChild(card);
      });
      
      // Carousel navigation
      function updateButtons() {
        const scrollLeft = container.scrollLeft;
        const maxScroll = container.scrollWidth - container.clientWidth;
        
        if (scrollLeft <= 0) {
          prevBtn.classList.add('uitk-carousel-button-paging-hidden');
          prevBtn.disabled = true;
        } else {
          prevBtn.classList.remove('uitk-carousel-button-paging-hidden');
          prevBtn.disabled = false;
        }
        
        if (scrollLeft >= maxScroll - 1) {
          nextBtn.classList.add('uitk-carousel-button-paging-hidden');
          nextBtn.disabled = true;
        } else {
          nextBtn.classList.remove('uitk-carousel-button-paging-hidden');
          nextBtn.disabled = false;
        }
      }
      
      prevBtn.addEventListener('click', () => {
        const scrollAmount = container.clientWidth;
        container.scrollBy({ left: -scrollAmount, behavior: 'smooth' });
      });
      
      nextBtn.addEventListener('click', () => {
        const scrollAmount = container.clientWidth;
        container.scrollBy({ left: scrollAmount, behavior: 'smooth' });
      });
      
      container.addEventListener('scroll', updateButtons);
      window.addEventListener('resize', updateButtons);
      
      // Initial button state
      updateButtons();
      
      // Show empty state if no accommodations
      if (accommodations.length === 0) {
        container.innerHTML = '<div style="text-align: center; padding: 40px; color: #999; width: 100%;">No accommodations found</div>';
        prevBtn.style.display = 'none';
        nextBtn.style.display = 'none';
      }
    })();
  </script>
</body>
</html>

